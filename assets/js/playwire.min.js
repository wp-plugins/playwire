/*! Playwire - v0.1.0
 * http://wordpress.org/plugins
 * Copyright (c) 2014; * Licensed GPLv2+ */
(function(e,t){"use strict";function a(t,a,i){var n=t*i,l=n+i;e(document.getElementsByClassName(a+"")).children("a").css("display","none").slice(n,l).css("display","inline-block"),e(document.getElementsByClassName(a+"")).find(".page[longdesc="+t+"]").addClass("active").siblings(".active").removeClass("active"),e(document.getElementsByClassName(a+"")).find(".current_page").val(t)}if("different"===PlaywireObject.compare_json){var i="single-video-posts-edit-dialog-different",n=e(document.getElementById(i));n.dialog({dialogClass:"wp-dialog",modal:!0,autoOpen:!0,closeOnEscape:!0,buttons:{Ignore:function(){e(this).dialog("close")},Update:function(){var a=t.confirm("Warning! This will overwrite the current post what whatever new data it recieves.");if(a!==!0)return!1;var i=e(document.getElementById("single-video-posts-edit-dialog-different-data-element")),l=i.data("nonce"),s=i.data("id"),r=e.ajax({dataType:"json",type:"post",url:PlaywireObject.ajaxurl,data:{action:"ajax_update_post",nonce:l,id:s}});r.done(function(e){e===!0&&(n.dialog("close"),location.reload())})},"Go Back":function(){return t.location.href=PlaywireObject.adminurl,!1}}})}if("removed"===PlaywireObject.compare_json){var l="single-video-posts-edit-dialog-removed",s=e(document.getElementById(l));s.dialog({dialogClass:"wp-dialog",modal:!0,autoOpen:!0,closeOnEscape:!0,buttons:{Ignore:function(){var t=e(document.getElementById("single-video-posts-edit-dialog-removed-data-element")),a=t.data("nonce"),i=t.data("id"),n=e.ajax({dataType:"json",type:"post",url:PlaywireObject.ajaxurl,data:{action:"ajax_delete_post_meta",nonce:a,id:i}});n.done(function(e){e===!0&&location.reload()})},Delete:function(){var a=t.confirm("Warning! This will delete the current post and any data associated with it in WordPress.");if(a!==!0)return!1;var i=e(document.getElementById("single-video-posts-edit-dialog-removed-data-element")),n=i.data("nonce"),l=i.data("id"),s=e.ajax({dataType:"json",type:"post",url:PlaywireObject.ajaxurl,data:{action:"ajax_delete_post",nonce:n,id:l}});s.done(function(e){e===!0&&(location.reload(),t.location.href=PlaywireObject.adminurl)})},"Go Back":function(){return t.location.href=PlaywireObject.adminurl,!1}}})}var r=document.getElementById("the-list");if(r&&r.addEventListener("click",function(t){if(t.target&&"editinline"===t.target.getAttribute("class")){inlineEditPost.revert();var a=inlineEditPost.getId(t.target),i=e(document.getElementById("inline_"+a+""));e(document.getElementsByClassName("post_category"),i).each(function(){var t,i=e(this).text();i=""!==i.trim()?i.trim():"0";var n=i.split(",");n=n?n[0]:"0",t=e(this).attr("id").replace("_"+a+"",""),e(document.getElementById(t+"-"+n+"")).first().find("input:radio").prop("checked",!0)})}}),t.self!==t.top){var o=document.getElementsByClassName("playlist");e(o).click(function(){var a=e(this).data("playlist-post-id"),i=t.dialogArguments||t.opener||t.parent||t.top;i.send_to_editor("[playwire_playlist playlist_post_id="+a+"]"+"")})}e(function(){e(document.getElementById(playwire_object.search_input)).fastLiveFilter(document.getElementById(playwire_object.search_list))}),1===parseInt(playwire_object.is_edit_screen,10)&&e("#wpbody-content h2").append(e("<a/>",{"class":"add-new-h2",href:playwire_object.edit_screen_url,text:playwire_object.edit_screen_text}));var d="#playwire_aspect_ratio_select",c="#playlist_preview_meta_box";document.getElementById("playwire_gallery_pagination_options"),document.getElementById("playwire_single_video"),document.getElementById("playwire_video_playlist"),e("#post select, #post input").on("change",function(){var t=e("input[name='playwire_metabox_nonce']").val(),a=e("input[name='playwire_video_layout']:checked").data("template"),i=e("select[name='playwire_video_playlist']").find(":selected").val(),n=e("select[name='playwire_single_video']").find(":selected").data("current-single-video"),l=e("input[name='playwire_aspect_ratio']:checked").val(),s=e("select."+l+"").find(":selected").val(),r=e("select."+l+"").find(":selected").data("height");e("select."+l+"").find(":selected").data("width");var o=e("input[name='playwire_gallery_pagination_options']:checked").val(),p={action:"ajax_preview",playwire_metabox_nonce:t,template:a,current_playlist:i,current_single_video:n,current_ratio:l,current_ratio_select:s,current_ratio_height:r,current_gallery_pagination:o};"single"===p.template,"gallery"===p.template,"custom"===p.current_ratio?(e(d+" "+"ul"+"").show(),e(d+" "+"select"+"").hide()):"classic"===p.current_ratio?(e(d+" "+"select.classic"+"").show(),e(d+" "+"ul"+"").hide(),e(d+" "+"select.widescreen"+"").hide()):"widescreen"===p.current_ratio&&(e(d+" "+"select.widescreen"+"").show(),e(d+" "+"ul"+"").hide(),e(d+" "+"select.classic"+"").hide()),e(c+" "+".inside"+"").fadeOut(),e.post(ajaxurl,p,function(t){e(c+" "+".inside"+"").fadeIn().html(t)})});var p="[id^=playwire_gallery]",h=playwire_object.gallery_limit;e(p).each(function(t){var a=e(this).attr("id")+"_"+t;e(this).addClass(a);var i=e(this).children("a").size();if(!(h>=i)){var n=Math.ceil(i/h);if(e(this).append(e("<div/>",{"class":"controls"}),e("<input/>",{type:"hidden","class":"current_page"}),e("<input/>",{"class":"show_per_page",type:"hidden"})),e(".current_page").val(0),e(".show_per_page").val(parseInt(h,10)),e(this).attr("id").match("_pagination$")){for(var l='<a class="prev">Prev</a>',s=0;n>s;)l+='<a class="page" longdesc="'+s+'">'+(s+1)+"</a>"+"",s++;l+='<a class="next">Next</a>',e(".controls",this).html(l)}if(e(".controls a.page:first",this).addClass("active"),e(this).attr("id").match("_more$")){var r='<a class="more-videos">More Videos</a>'+"";e(".controls",this).html(r)}(e(this).attr("id").match("_pagination$")||e(this).attr("id").match("_more$"))&&(e(this).children("a").css("display","none"),e(this).children("a").slice(0,h).css("display","inline-block"))}}),e(".controls").on("click","a",function(){var t=e(this).attr("longdesc"),i=e(this).parent().parent().attr("class"),n=parseInt(e(this).parent().parent().find(".show_per_page").val(),0),l=e(this).parent().parent().find(".current_page").val();if(e(this).hasClass("next")&&1==e(this).siblings(".active").next(".page").length){var t=parseInt(l,0)+1;a(t,i,n,l)}else if(e(this).hasClass("prev")&&e(this).siblings(".active").prev(".page").attr("longdesc")>=0){var t=parseInt(l,0)-1;a(t,i,n,l)}if(e(this).hasClass("more-videos")){var s=e(this).parent().parent().attr("class");e("."+s+"").find("> a:hidden").first();var r=e("."+s+" a"+"").size()-1,o=e("."+s+" a:visible"+"").size()-1,n=parseInt(o,10)+parseInt(n,10);r>o?e("."+s+" a:lt("+n+")"+"").show():this.style.display="none"}e(this).hasClass("page")&&a(t,i,n,l)}),e("div[id^='playwire_gallery'] a .vertical-video-alignment, .flexslider-control ul.slides li").hover(function(){e(this).children(".playwire_play_icon").show()},function(){e(this).children(".playwire_play_icon").hide()});var u=document.getElementsByClassName("playwire-upload-placeholder");e(".playwire-upload input[type=file]").on("change",function(){e(u).text(e(this).val().replace(/C:\\fakepath\\/i,""))})})(jQuery,this);